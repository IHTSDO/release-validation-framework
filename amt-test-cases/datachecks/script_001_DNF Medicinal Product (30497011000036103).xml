
<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

<suite name="script_001_DNF Medicinal Product (30497011000036103)" verbose="2">

	<test name="01 Some Medicinal Products exist">
        <parameter name="query" value="select count(*) from &lt;PROSPECTIVE&gt;.concept_active where id in (select sourceid from rf2_cr_transitiveclosuretable where destinationId = 30497011000036103);"/>
        <parameter name="description" value=""></parameter>
		<parameter name="qualifier" value=">"></parameter>
		<parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

<!-- Basic Content/Descriptions validation !-->
    <test name="02 All Medicinal Products are 900000000000073002|Defined">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_active
										where isKindOf_cr(id,30497011000036103)
										and not isKindOf_cr(id,30450011000036109)
										and definitionStatusId != 900000000000073002;"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="03 Medicinal Product is 900000000000073002|Defined">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_active
										where id = 30497011000036103
										and definitionStatusId != 900000000000073002;"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
	<test name="04 All concepts with semantic tag (medicinal product) on AMT module are kinds of 30497011000036103|Medicinal Product (or itself)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.description_active
										where isActiveConcept_cr(conceptId)
										and typeId = 900000000000003001
										and SUBSTRING(term,-19,19) = '(medicinal product)'
										and NOT isKindOf_cr(conceptId,30497011000036103)
                                        and moduleid = 900062011000036108;"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="05 All concepts that are kinds of 30497011000036103|Medicinal Product (and not kinds 30450011000036109|MPUU) have semantic tag (medicinal product)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.description_active
										where isKindOf_cr(conceptId,30497011000036103)
										and NOT isKindOf_cr(conceptId,30450011000036109)
										and typeId = 900000000000003001
										and SUBSTRING(term,-19,19) != '(medicinal product)';"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="06 Concept 30497011000036103|Medicinal Product has FSN = 'medicinal product (medicinal product)'">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.description_active
										where typeId = 900000000000003001
										and conceptId = 30497011000036103
										and term != BINARY 'medicinal product (medicinal product)';"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="07 Concept 30497011000036103|Medicinal Product has SYN = 'medicinal product' or 'MP - medicinal product'">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.description_active
										where typeId = 900000000000013009
										and conceptId = 30497011000036103	
										and term != BINARY 'medicinal product'
                                        and term != BINARY 'MP - medicinal product';"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="08 Concept 30497011000036103|Medicinal Product has SYN = 'medicinal product' or 'MP - medicinal product'">
        <parameter name="query" value="select get_cr_ADRS_PT(30497011000036103) = BINARY 'medicinal product';"/>
		<parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>
	
<!-- Defining/Source properties !-->

	<test name="09 has intended active ingredient (700000081000036101) relationships only have sourceId that are kinds of 30497011000036103|Medicinal Product">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where typeId = 700000081000036101
										and NOT isKindOf_cr(sourceId,30497011000036103);"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
	<test name="10 has intended active ingredient relationships(700000081000036101) only have destinationId 30388011000036105|medicinal substance">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where typeId = 700000081000036101
										and NOT isKindOf_cr(destinationId,30388011000036105);"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="11 Medicinal Products only have [700000081000036101|has intended active ingredient] OR [116680003|Is a] relationships - (except 30450011000036109|MPUU)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where isKindOf_cr(sourceId,30497011000036103)
										and NOT isKindOf_cr(sourceId,30450011000036109)
										and typeId not in (700000081000036101,116680003);"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
	<test name="12 Every Medicinal Product has at least 1 has intended active ingredient(700000081000036101) relationship">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_active AS C
										where id not in (select sourceId from &lt;PROSPECTIVE&gt;.relationship_active
														 where typeId = 700000081000036101)
										and isKindOf_cr(id,30497011000036103)
										and NOT isKindOf_cr(id,30450011000036109);"/>
        <parameter name="resultCount" value="0"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="13 All DNF hasIAI relationships are grouped (group != 0)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where typeId = 700000081000036101 
										and relationshipgroup = 0;"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

</suite>
