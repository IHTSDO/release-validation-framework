<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

<suite name="script_0007_Containered trade product pack reference set (929360051000036108) content validation" verbose="2">

    <test name="01 Containered trade product pack reference set (929360051000036108) is populated">
        <parameter name="query" value="SELECT count(*) FROM &lt;PROSPECTIVE&gt;.simplerefset_active WHERE refsetId = 929360051000036108;"/>
        <parameter name="expectedValue" value="0"/>
		<parameter name="qualifier" value=">"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

    <test name="02 RefsetId(929360051000036108) is an active concept">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.concept_active where id = 929360051000036108;"/>
        <parameter name="resultCount" value="1"/>
        <parameter name="skip" value="true"/> <!--Refactor this test-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
    
    <test name="03 All active references are from module 900062011000036108 [Australian Medicines Terminology module]">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.simplerefset_&lt;SNAPSHOT&gt; WHERE refsetId = 929360051000036108 AND moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="04 FSN is 'Containered trade product pack reference set (foundation metadata concept)'">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.description_active WHERE conceptId = 929360051000036108
										AND typeId = 900000000000003001
										AND term = 'Containered trade product pack reference set (foundation metadata concept)'
										and id != 965507091000036115;"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="05 PT (in ADRS) is 'Containered trade product pack reference set'">
        <parameter name="query" value="SELECT get_cr_ADRS_PT(929360051000036108) = 'Containered trade product pack reference set';"/>
		<parameter name="description" value="query returns 1 if the string matches, otherwise 0"></parameter>
        <parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

    <test name="06 Only active descriptions are the expected PT and FSN">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.description_active WHERE conceptId = 929360051000036108
										AND term != 'Containered trade product pack reference set (foundation metadata concept)'
										AND term != 'Containered trade product pack reference set'
										AND term != 'CTPP (containered trade product pack) reference set';"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="07 Foundation refset IS A child of 446609009 | Simple type reference set">
        <parameter name="query" value="select isChildOf_cr(929360051000036108, 446609009);"/>
		<parameter name="description" value="query returns 1 if true, otherwise 0"></parameter>
        <parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

	<test name="08 Foundation refset only has parent 446609009 | Simple type reference set">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where sourceId = 929360051000036108
                                        and typeId = 116680003
										and destinationId not in (446609009);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
    <test name="09 Only Contains Active descendants of Containered trade product pack">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.simplerefset_active
										where refsetId = 929360051000036108
										and NOT isDescendentOf_cr(referencedComponentid,30537011000036101);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
	<test name="10 Does not contain any descendants of the other 6 boxes (non-MP)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.simplerefset_active
										where refsetId = 929360051000036108
										and (
											isDescendentOf_cr(referencedComponentid,30497011000036103)
											OR
											isDescendentOf_cr(referencedComponentid,30450011000036109)
											OR
											(isDescendentOf_cr(referencedComponentid,30513011000036104) AND NOT isDescendentOf_cr(referencedComponentid,30537011000036101))
											OR
											isDescendentOf_cr(referencedComponentid,30560011000036108)
											OR
											isDescendentOf_cr(referencedComponentid,30425011000036101) 
											OR
											(isDescendentOf_cr(referencedComponentid,30404011000036106) AND NOT isDescendentOf_cr(referencedComponentid,30537011000036101))
											);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
	
	<test name="11 Contains all Active Containered trade product packs">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_active
										where not isActiveMemberOf_cr_refset(id,929360051000036108)
										and isDescendentOf_cr(id,30537011000036101);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

</suite>

