<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

<suite name="script_023_Medication container type reference set (1183941000168107) content validation" verbose="2">

    <test name="01 Medication container type reference set(1183941000168107) is populated">
        <parameter name="query" value="SELECT count(*) FROM &lt;PROSPECTIVE&gt;.simplerefset_active WHERE refsetId = 1183941000168107;"/>
        <parameter name="expectedValue" value="0"/>
		<parameter name="qualifier" value=">"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

    <test name="02 RefsetId(1183941000168107) is an active concept">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.concept_active where id = 1183941000168107;"/>
        <parameter name="resultCount" value="1"/>
        <parameter name="skip" value="true"/> <!--Refactor this test-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
    
    <test name="03 All active references are on module 900062011000036108|AMT Module">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.simplerefset_&lt;SNAPSHOT&gt; WHERE refsetId = 1183941000168107 AND moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="04 FSN is 'Medication container type reference set (foundation metadata concept)'">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.description_active WHERE conceptId = 1183941000168107
										AND typeId = 900000000000003001
										AND term = 'Medication container type reference set (foundation metadata concept)'
										AND id != 2674161000168119;"/>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="05 PT (in ADRS) is 'Medication container type reference set'">
        <parameter name="query" value="SELECT get_cr_ADRS_PT(1183941000168107) = 'Medication container type reference set';"/>
		<parameter name="description" value="query returns 1 if the string matches, otherwise 0"></parameter>
        <parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>
	
    <test name="06 Acceptable synonym (in ADRS) is 'Medicine container type reference set'">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.langrefset_active
                                        where refsetId = 32570271000036106 and value1 = 900000000000549004 
                                        and referencedComponentId in (SELECT id from &lt;PROSPECTIVE&gt;.description_active where term = 'Medicine container type reference set')
                                        and referencedComponentId != 2674321000168114;"/>
		<parameter name="description" value="query returns 1 if the string matches, otherwise 0"></parameter>
        <parameter name="resultCount" value="0"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="07 All active members are descendents of 30446011000036105 |container type (AU qualifier)|">
        <parameter name="description" value=""></parameter>
		<parameter name="query" value="Select * from &lt;PROSPECTIVE&gt;.concept_active
										Where isActiveMemberOf_cr_refset(id, 1183941000168107)
										and NOT isDescendentOf_cr(id, 30446011000036105);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="08 All descendents of 30446011000036105 |container type (AU qualifier)| are active members">
        <parameter name="description" value=""></parameter>
		<parameter name="query" value="Select * from &lt;PROSPECTIVE&gt;.concept_active
										Where NOT isActiveMemberOf_cr_refset(id, 1183941000168107)
										and isDescendentOf_cr(id, 30446011000036105);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="10 IS A child of 32570701000036108 | Reference sets for Medications">
        <parameter name="query" value="select isChildOf_cr(1183941000168107, 32570701000036108);"/>
		<parameter name="description" value="query returns 1 if true, otherwise 0"></parameter>
        <parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>
	
	<test name="11 IS A child of 446609009 | Simple type reference set">
        <parameter name="query" value="select isChildOf_cr(1183941000168107, 446609009);"/>
		<parameter name="description" value="query returns 1 if true, otherwise 0"></parameter>
        <parameter name="expectedValue" value="1"/>
        <parameter name="skip" value="true"/> <!--Will come back to expected value tests-->
        <classes>
            <class name="au.gov.nehta.test.ExpectedValueTest"/>
        </classes>
    </test>

	<test name="12 Only has parents 32570701000036108 | Reference sets for Medications  AND 446609009 | Simple type reference set">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_active
										where sourceId = 1183941000168107
                                        and typeId = 116680003
										and destinationId not in (32570701000036108,446609009);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

	<test name="13 No duplicate active references (referencedComponentId is unique within reference set)">
        <parameter name="description" value=""></parameter>
		<parameter name="query" value="SELECT referencedComponentId, count(*) FROM &lt;PROSPECTIVE&gt;.simplerefset_active
										WHERE refsetId = 1183941000168107
										GROUP BY referencedComponentId
										HAVING count(*) > 1;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>
</suite>

