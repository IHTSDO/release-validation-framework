<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

<suite name="script_099_Mixed_AMT_Tests" verbose="2">

    <test name="01 All (active) members of AMT simple type refsets are active">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.simplerefset_active
                                        where refsetId in (
                                                                select id from &lt;PROSPECTIVE&gt;.concept_active
                                                                where isDescendentOf_cr(id, 446609009)
                                                                and moduleId = 900062011000036108
                                                                )
                                        and referencedComponentId not in (select id from &lt;PROSPECTIVE&gt;.concept_active);"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="09 All concepts with AMT descriptions are on AMT module (excluding IS A)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt;
                                        where id in (select conceptId from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and moduleId != 900062011000036108
                                        and id != 116680003;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="10 All descriptions for AMT concepts on AMT module">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt;
                                        where conceptId in (select id from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>



    <test name="12 All inferred relationships for AMT concepts on AMT module">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.relationship_&lt;SNAPSHOT&gt;
                                        where sourceId in (select id from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="13 All subtypes of Australian concept on AMT module">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_active
                                        where isKindOf_cr(id, 30561011000036101)
                                        and moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="14 All relationship types for AMT are on AMT module (except IS A)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt;
                                        where id in (select typeId from &lt;PROSPECTIVE&gt;.relationship_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and moduleId != 900062011000036108
                                        and id != 116680003;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="15 All simple refset memberships of AMT concepts are on AMT module (except Tas+Vic refsets)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.simplerefset_active
                                        where referencedComponentId in (select id from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and moduleId != 900062011000036108
                                        and refsetId not in (1050711000168101,	1141581000168103);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="16 All simple refsets containing AMT concepts are on AMT module (except Tas+Vic refsets)">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.simplerefset_active
                                        where referencedComponentId in (select id from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and refsetId not in (select id from &lt;PROSPECTIVE&gt;.concept_&lt;SNAPSHOT&gt; where moduleId = 900062011000036108)
                                        and refsetId not in (1050711000168101,	1141581000168103);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>



    <test name="18 All inferred concrete domains on AMT module">
        <parameter name="query" value="select * from rf2_cr_ccsrefset_snapshot
                                        where moduleId != 900062011000036108
                                        union
                                        select * from rf2_cr_ccirefset_snapshot
                                        where moduleId != 900062011000036108
                                        and refsetId != 900000000000456007;"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="02 All ADRS referenced components that are for subtypes of 30561011000036101|Australian concept (concept)| are on AMT Module">
        <parameter name="query" value="SELECT * FROM &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
										WHERE refsetId = 32570271000036106
										AND referencedComponentId in (select id from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt; where isKindOf_cr(conceptId, 30561011000036101))
										AND moduleId != 900062011000036108;"/>
        <parameter name="resultCount" value="null"/>
        <parameter name="skip" value="true"/> <!--Uses a function or proc that needs refactoring-->
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>


    <test name="08 All Australian common model component are for AU/core metadata descriptions">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
                                         WHERE refsetId = 32570271000036106
                                         AND moduleId = 161771000036108
                                         and referencedComponentId not in (select id from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt;
                                                                         where moduleId in (161771000036108,900000000000012004))
                                         and referencedComponentId not in (select id from &lt;PROSPECTIVE&gt;.textdefinition_&lt;SNAPSHOT&gt;
                                                                         where moduleId in (161771000036108,900000000000012004));"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="08 All referenced AU/core metadata descriptions descriptions are referenced on Australian common model component module">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt;
                                         where moduleId in (161771000036108,900000000000012004) and typeId != 900000000000003001
                                         and id not in (select referencedComponentId from &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
                                                             WHERE refsetId = 32570271000036106 AND moduleId = 161771000036108)
                                         and id in (select referencedComponentId from &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
                                                             WHERE refsetId = 32570271000036106);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <!-- ########AMT#############################  -->
    <test name="08 All AMT references are for AMT descriptions">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
                                         WHERE refsetId = 32570271000036106
                                         AND moduleId = 900062011000036108
                                         and referencedComponentId not in (select id from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt;
                                                     where moduleId = 900062011000036108)
                                         and referencedComponentId not in (select id from &lt;PROSPECTIVE&gt;.textdefinition_&lt;SNAPSHOT&gt;
                                                     where moduleId = 900062011000036108);"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>

    <test name="08 All AMT descriptions are referenced on AMT module">
        <parameter name="query" value="select * from &lt;PROSPECTIVE&gt;.descriptions_&lt;SNAPSHOT&gt;
                                         where moduleId = 900062011000036108 and typeId != 900000000000003001
                                         and id not in (select referencedComponentId from &lt;PROSPECTIVE&gt;.langrefset_&lt;SNAPSHOT&gt;
                                                             WHERE refsetId = 32570271000036106 AND moduleId = 900062011000036108)
                                         and id != 170037011000036115;"/>
        <parameter name="resultCount" value="null"/>
        <classes>
            <class name="au.gov.nehta.test.ResultCountTest"/>
        </classes>
    </test>


</suite>

